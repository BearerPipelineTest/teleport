suite: test cluster role
templates:
  - clusterrole.yaml
tests:
  - it: should not render when create=false
    set:
      rbac.create: false
    asserts:
      - hasDocuments:
        count: 0
  - it: sets name and labels
    set:
      teleport.name: name
      teleport.fullname: fullname
    release:
      name: teleport-release
    asserts:
      - hasDocuments:
          count: 1
      - isKind:
          of: ClusterRole
      - equal:
          path: metadata.labels
          value:
            app: teleport
            chart: teleport-0.0.13
            fullname: teleport-release
            heritage: Helm
            release: teleport-release